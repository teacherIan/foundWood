/* IPAD MENU Z-INDEX FIX - CONSOLIDATED SOLUTION */
/* This file consolidates all iPad-specific z-index and stacking context fixes */

/* IPAD PRO SPECIFIC TARGETING - More precise than existing rules */
@media (min-width: 1024px) and (orientation: portrait) {
  
  /* STEP 1: Fix container stacking contexts */
  .app-container,
  .appContainer {
    position: static !important;
    transform: none !important;
    isolation: auto !important;
    contain: none !important;
    will-change: auto !important;
    filter: none !important;
    z-index: auto !important;
  }

  /* STEP 2: Fix canvas wrapper stacking contexts */
  .appContainer > div {
    position: static !important;
    transform: none !important;
    isolation: auto !important;
    contain: none !important;
    will-change: auto !important;
    /* Note: Don't force filter: none here as it prevents canvas blur */
  }

  /* STEP 3: Set clear z-index hierarchy */
  
  /* Canvas - Background layer */
  canvas,
  canvas[data-engine],
  canvas[style*="position"] {
    z-index: 1 !important;
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 100vw !important;
    height: 100vh !important;
  }

  /* Header - Top overlay layer */
  .header {
    z-index: 10000 !important; /* Consistent high value */
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 100vw !important;
    height: 10vh !important;
    /* Remove stacking context creators */
    isolation: auto !important;
    contain: none !important;
    transform: none !important;
    will-change: auto !important;
    filter: none !important;
    /* Enhanced visibility */
    background: rgba(245, 245, 245, 0.95) !important;
    backdrop-filter: blur(10px) !important;
    -webkit-backdrop-filter: blur(10px) !important;
    pointer-events: none !important;
  }

  /* Menu container */
  .menu {
    pointer-events: auto !important;
    z-index: 10001 !important;
    position: relative !important;
    display: flex !important;
    width: 100% !important;
    justify-content: space-around !important;
    align-items: center !important;
    /* Remove stacking context creators */
    isolation: auto !important;
    contain: none !important;
    transform: none !important;
    will-change: auto !important;
  }

  /* Menu items */
  .menu-item {
    pointer-events: auto !important;
    z-index: 10002 !important;
    position: relative !important;
    opacity: 1 !important;
    visibility: visible !important;
    display: flex !important;
    /* Remove stacking context creators */
    isolation: auto !important;
    contain: none !important;
    transform: none !important;
    will-change: auto !important;
    /* Enhanced styling for visibility */
    background: rgba(255, 255, 255, 0.95) !important;
    border: 2px solid #77481c !important;
    border-radius: 2em !important;
    padding: 0.3em 0.6em !important;
    font-size: clamp(1.5rem, 4vw, 3.5rem) !important;
    -webkit-text-stroke: 2px #77481c !important;
    color: #fff !important;
    backdrop-filter: blur(5px) !important;
    -webkit-backdrop-filter: blur(5px) !important;
    box-shadow: 0 2px 8px rgba(119, 72, 28, 0.3) !important;
    min-height: 44px !important;
    min-width: 44px !important;
  }

  /* Icon */
  .icon {
    z-index: 10003 !important;
    pointer-events: auto !important;
    opacity: 1 !important;
    visibility: visible !important;
    position: relative !important;
    /* Remove stacking context creators */
    isolation: auto !important;
    contain: none !important;
    transform: none !important;
    will-change: auto !important;
  }

  /* Override any React Spring animations that might hide elements */
  .header *,
  [class*="header"] *,
  [class*="menu"] *,
  .menu > div,
  .menu > div > div {
    opacity: 1 !important;
    visibility: visible !important;
    pointer-events: auto !important;
    /* Remove stacking context creators */
    isolation: auto !important;
    contain: none !important;
    transform: none !important;
    will-change: auto !important;
  }

  /* Gallery and other overlays */
  .typesContainer {
    z-index: 20000 !important;
  }

  .galleryContainer {
    z-index: 20000 !important;
  }

  .contactContainer {
    z-index: 20000 !important;
  }
}

/* IPAD PRO 11" SPECIFIC */
@media (min-width: 834px) and (max-width: 834px) and (min-height: 1194px) and (orientation: portrait) {
  /* Apply same rules for iPad Pro 11" */
  .header { z-index: 10000 !important; }
  .menu { z-index: 10001 !important; }
  .menu-item { z-index: 10002 !important; }
  .icon { z-index: 10003 !important; }
  canvas { z-index: 1 !important; }
}

/* DEBUG STYLES (remove in production) */
@media (min-width: 1024px) and (orientation: portrait) {
  /* Uncomment these for visual debugging
  .header {
    border: 3px solid red !important;
  }
  
  .menu-item {
    background: lime !important;
    color: black !important;
  }
  
  canvas {
    border: 3px solid blue !important;
  }
  */
}
